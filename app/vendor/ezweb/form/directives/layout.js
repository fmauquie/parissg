"use strict";define(["angular","./formDirective"],function(a,b){return a.module("ezweb.form.directives.layout",[]).directive("ezFormGroup",["$compile",function(){return new b({transclude:!1,autoTransclude:!1,initOptions:{html:""},_parseExtendedAttributes:function(a){var b=a.find("[ez-control-element]:first");if(0===b.size()&&(b=a.find("[ngModel]:first"),b.attr("ez-control-element","")),this.options.fieldId=b.attr("id"),0===this.options.fieldName.length){var c=b.attr("name");if(c&&c.length>0)this.options.fieldName=c;else{var d=b.attr("ng-model");d&&d.length>0&&(this.options.fieldName=d.replace(".","_"),b.attr("name",this.options.fieldName))}}this.options.fieldId||(this.options.fieldId=this.options.fieldName),b.attr("id",this.options.fieldId),b.addClass("form-control"),this.options.html=a.html()},_buildBaseFormElement:function(){return this.options.html}})}]).directive("formHorizontal",function(){function b(b,c){var d=[],e=[];a.forEach(b,function(a,b){a>0&&12>a&&(c.ezwebForm.horizontal.ratios[b]={labelSize:a,controlSize:12-a,breakpoint:b},d.push(["col",b,a].join("-")),e.push(["col",b,12-a].join("-")))}),c.ezwebForm.horizontal.labelClasses=d.join(" "),c.ezwebForm.horizontal.controlClasses=e.join(" ")}return{restrict:"C",require:"form",link:{pre:function(c,d,e,f){f.ezwebForm||(f.ezwebForm={}),f.ezwebForm.horizontal={ratios:{},labelClasses:"",controlClasses:""},a.isDefined(e.ezHorizontalRatios)?c.$watch(e.ezHorizontalRatios,function(c){a.isDefined(c)&&b(c,f)},!0):b({sm:3},f)}}}}).directive("formInline",function(){return{restrict:"C",require:"form",link:{pre:function(a,b,c,d){d.ezwebForm||(d.ezwebForm={}),d.ezwebForm.inline={}}}}}).directive("navbarForm",function(){return{restrict:"C",require:"form",link:{pre:function(a,b,c,d){d.ezwebForm||(d.ezwebForm={}),d.ezwebForm.inline={}}}}}).directive("ezControlLabel",[function(){return{restrict:"A",require:"^form",link:function(b,c,d,e){a.isDefined(e.ezwebForm)&&(a.isDefined(e.ezwebForm.horizontal)&&b.$watch(function(){return e.ezwebForm.horizontal.labelClasses},function(b,d){a.isDefined(d)&&c.removeClass(d),a.isDefined(b)&&c.addClass(b)}),a.isDefined(e.ezwebForm.inline)&&c.addClass("sr-only"))}}}]).directive("ezControlBody",[function(){return{restrict:"A",require:"^form",link:function(b,c,d,e){a.isDefined(e.ezwebForm)&&a.isDefined(e.ezwebForm.horizontal)&&b.$watch(function(){return e.ezwebForm.horizontal.controlClasses},function(b,d){a.isDefined(d)&&c.removeClass(d),a.isDefined(b)&&c.addClass(b)})}}}]).directive("ezControlElement",[function(){return{require:["^formDirective","ngModel"],link:function(b,c,d,e){var f=e[0],g=e[1];if(a.isDefined(f.ngModelController)||a.isDefined(f.$input))throw"Bad form directive definition: ngModelController is already defined.";f.ngModelController=g,f.$input=c,g.ezwebForm=g.ezwebForm||{},g.ezwebForm.blurred=!1,c.on("blur.ezControlElement",function(){b.$apply(function(){g.ezwebForm.blurred=!0})})}}}])});