define(["angular","jquery","../../core/utilities","../vendor/highcharts/highcharts","less!../styles/chart"],function(a,b,c){"use strict";return a.module("ezweb.chart.directives.chart",[]).directive("ezChart",["$window",function(){var d={colors:["#e60028","#8E7165","#484848","#aa8778","#858585","#D1A694","#ABABAB"],credits:{enabled:!1},tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}:</span><strong>{point.y}</strong><br />',useHTML:!0},plotOptions:{line:{dataLabels:{enabled:!1},marker:{enabled:!1}},area:{marker:{enabled:!1}},areaspline:{marker:{enabled:!1}},spline:{marker:{enabled:!1}}}};return{restrict:"E",transclude:!0,template:'<div class="ez-chart"><div class="ez-chart-container"></div><div ng-transclude></div></div>',scope:{title:"@",type:"@?",options:"&?",api:"=?"},controller:["$scope",function(c){this.api=null,this.type=a.isDefined(c.type)?c.type:"line",this.chartConfig=b.extend(!0,{},d),this.chartContainer=null,this.initAxisQueue=[],this.initSeriesQueue=[],this.initConfig=function(a){var d=b.extend(!0,{},this.chartConfig,a);d=b.extend(!0,d,{chart:{type:this.type},title:{text:c.title}}),this.chartConfig=d},this.init=function(b,c){null===this.api&&(this.initConfig(c),this.chartContainer=b.find(".ez-chart-container"),this.chartContainer.highcharts(this.chartConfig),this.api=this.chartContainer.highcharts(),a.forEach(this.initAxisQueue,function(a){this.addAxis(a.type,a.config)},this),a.forEach(this.initSeriesQueue,function(a){this.addSeries(a)},this),this.initAxisQueue=this.initSeriesQueue=[])},this.addSeries=function(a){if(null!==this.api){var b=this.api.get(a.id);null===a.data?this.api.showLoading():this.api.hideLoading(),null!==b?b.setData(a.data):this.api.addSeries(a)}else this.initSeriesQueue.push(a)},this.addAxis=function(b,c){if(null!==this.api){var d=this.api.get(c.id);if(null!==d)d.update(c);else{var e="x"===b?!0:!1,f=e?this.api.xAxis:this.api.yAxis,g=f[0];1!==f.length||a.isDefined(g.userOptions.id)?this.api.addAxis(c,e):g.update(c)}}else this.initAxisQueue.push({type:b,config:c})},this.setTooltipConfig=function(a){this.chartConfig=b.extend(!0,this.chartConfig,{tooltip:a})},this.configurePlotOptions=function(a,c){this.chartConfig.plotOptions[a]=this.chartConfig.plotOptions[a]||{},this.chartConfig.plotOptions[a]=b.extend(!0,this.chartConfig.plotOptions[a],c)}}],link:function(d,e,f,g){var h=d.options(),i=a.isObject(h)?h:{},j={series:"ezChartSeries",xAxis:"ezChartAxis",yAxis:"ezChartAxis",plotOptions:"ezChartPlot",tooltip:"ezChartTooltip"};a.forEach(j,function(b,c){if(a.isDefined(this[c]))throw"API violation in ezChart directive for "+c+" option. You should use directive "+b+" instead"},i);var k={chart:{}};c.evaluateAndApply(d.$parent,f,k,["colors","credits","exporting","legend","loading","subtitle"],{}),c.evaluateAndApply(d.$parent,f,k.chart,["alignTicks","animation","ignoreHiddenSeries","inverted","panning","reflow","shadow","showAxes"],{opposite:!1,reversed:!1,showEmpty:!0}),c.copyIfDefined(f,k.chart,["backgroundColor","borderColor","borderRadius","borderWidth","className","height","margin","panKey","pinchType","plotBackgroundColor","plotBackgroundImage","plotBorderWidth","spacing","type","width","zoomType"]);var l=b.extend(!0,{},i,k);g.init(e,l),d.api=g.api,d.$watch(function(){return e.parent().width()},function(){g.api.reflow()})}}}])});