define(["angular","./ezFixedPanel"],function(a){"use strict";return a.module("ezweb.layout",["ngRoute","ezweb.layout.fixedPanel"]).provider("ezweb.layout.service",[function(){var b={},c=null;this.register=function(c,d){if(a.isDefined(b[c]))throw"The layout "+c+" already exists.";b[c]=d},this.setDefault=function(d){if(null!==c)throw"Default layout is already defined.";if(a.isUndefined(b[d]))throw d+" layout does not exist. Can't make it the default.";c=d};var d=function(a){return"ezweb.layout."+a};this.$get=["$templateCache","$location","ezweb.core.services.scope",function(e,f,g){var h={};a.forEach(b,function(a,b){null===c&&(c=b);var f=d(b);h[b]=f,e.put(f,a)}),b={};var i=g.ensure("layout",{templateNames:h,defaultTemplateName:d(c),current:void 0,changeFor:function(b){if(a.isUndefined(b))this.current=this.defaultTemplateName;else if(a.isString(b))this.current=this.templateNames[b];else{if(!a.isFunction(b))throw"Unrecognized layout type for route "+f.path();this.current=this.templateNames[b.call(null)]}}});return i}]}]).directive("ezLayout",["$rootScope","$route","ezweb.layout.service",function(b,c,d){return{restrict:"EA",template:'<ng-include src="ezweb.layout.current"></ng-include>',link:function(){b.$on("$routeChangeStart",function(a,b){d.changeFor(b.layout)}),a.isDefined(c.current)&&d.changeFor(c.current.layout)}}}])});