define(["angular","jquery","../services/scopeServices","../services/winServices","less!../styles/responsive"],function(a,b){"use strict";return a.module("ezweb.core.directives.responsive",["ezweb.core.services.win","ezweb.core.services.responsive"]).directive("ezResponsive",["ezweb.core.services.responsive","ezweb.core.services.win","$window","$animate",function(c,d,e,f){var g="ez-responsive-orientation-",h="ez-responsive-breakpoint-",i=["xs","sm","md","lg"];return{controller:["$scope","$element","$attrs",function(j,k,l){var m=this;if(!k.is("body"))throw"ezResponsive only works as an attribute to the body element !";if(k.append('<div id="ez-responsive-xs" class="visible-xs"></div>'),k.append('<div id="ez-responsive-sm" class="visible-sm"></div>'),k.append('<div id="ez-responsive-md" class="visible-md"></div>'),k.append('<div id="ez-responsive-lg" class="visible-lg"></div>'),this.parts=[],this.defaultPart=!1,l.ezResponsive){var n=l.ezResponsive;a.forEach(n.split(","),function(a,b){var c=a.trim();if(""===c)throw"Invalid part, index "+b;m.parts.push(c)}),this.defaultPart=l.defaultPart?l.defaultPart.trim():this.parts[0]}this.defaultBreakpoint=l.defaultBreakpoint?l.defaultBreakpoint.trim():"xs",this.affectedBreakpoints=function(){return i.slice(0,i.indexOf(this.defaultBreakpoint)+1)};var o={width:-1,height:-1};d.watch(function(d){var e=c.breakpoint;if(a.forEach(i,function(a){b("#ez-responsive-"+a+":visible").size()>0&&(c.breakpoint=a),c.breakpoint===!1&&(c.breakpoint="lg")}),e===!1?k.addClass(h+c.breakpoint):e!==c.orientation&&(f.removeClass(k,h+e),f.addClass(k,h+c.breakpoint)),d.width!==o.width||d.height>o.height){var j=c.orientation;c.portrait=d.width/d.height<1.33,c.landscape=!c.portrait,c.orientation=c.portrait?"portrait":"landscape",j===!1?k.addClass(g+c.orientation):j!==c.orientation&&(f.removeClass(k,g+j),f.addClass(k,g+c.orientation))}o=a.copy(d)}),j.$watch("ezweb.responsive.part",function(a,c){e.scrollTo(0,0);var d=b("body");d.removeClass("ez-responsive-status-from-left"),d.removeClass("ez-responsive-status-from-right"),d.addClass(m.parts.indexOf(c)<m.parts.indexOf(a)?"ez-responsive-status-from-left":"ez-responsive-status-from-right")}),j.$on("$routeChangeSuccess",function(){c.part=m.defaultPart})}]}}]).directive("ezResponsiveParts",["ezweb.core.services.responsive",function(b){return{require:"^ezResponsive",link:{pre:function(c,d,e,f){f.parts=[];var g=e.ezResponsiveParts;a.forEach(g.split(","),function(a,b){var c=a.trim();if(""===c)throw"Invalid part, index "+b;f.parts.push(c)}),f.defaultPart=e.defaultPart?e.defaultPart.trim():f.parts[0],f.defaultBreakpoint=e.defaultBreakpoint?e.defaultBreakpoint.trim():"xs",b.part=f.defaultPart}}}}]).directive("ezResponsivePagePart",["$animate",function(a){return{require:"^ezResponsive",link:function(b,c,d,e){var f=e.affectedBreakpoints().map(function(a){return"hidden-"+a}),g=f.join(" "),h=d.ezResponsivePagePart.trim();if(0===h.length)throw"The page part needs to reference one of the parts defined in ezResponsive.";c.addClass("ez-responsive-page-part"),c.addClass(g),b.$watch("ezweb.responsive.part",function(b){h===b?a.removeClass(c,g):a.addClass(c,g)})}}}]).directive("ezResponsivePartTrigger",["$animate","ezweb.core.services.responsive",function(a,b){return{require:"^ezResponsive",link:function(c,d,e){var f=e.ezResponsivePartTrigger.trim();if(0===f.length)throw"The trigger needs to reference one of the parts defined in ezResponsive.";d.addClass("ez-responsive-part-trigger"),d.on("click.ezweb.responsive",function(){b.part=f,c.$apply()}),c.$watch("ezweb.responsive.part",function(b){f===b?a.addClass(d,"active"):a.removeClass(d,"active")})}}}])});